<div class="modern-auth-page">
  <div class="auth-background"></div>

  <div class="auth-container register-container">
    <div class="auth-header">
      <div class="brand-logo">üèîÔ∏è</div>
      <h1 class="auth-title">Join Our Community</h1>
      <p class="auth-subtitle">
        Create your account to start booking amazing mountain cottages
      </p>
    </div>

    <form (ngSubmit)="onSubmit()" #registerForm="ngForm" class="auth-form">
      <div class="modern-form-group">
        <label for="username">
          <span class="label-icon">üë§</span>
          Username *
        </label>
        <input
          type="text"
          id="username"
          name="username"
          [(ngModel)]="formData.username"
          required
          minlength="3"
          class="modern-input"
          placeholder="Choose a username"
        />
      </div>

      <div class="form-group">
        <label for="password">Password: *</label>
        <input
          type="password"
          id="password"
          name="password"
          [(ngModel)]="formData.password"
          (input)="onPasswordInput()"
          required
          minlength="6"
          maxlength="10"
        />
        <small
          class="field-hint"
          *ngIf="!showPasswordErrors || passwordErrors.length === 0"
        >
          6-10 characters, must begin with a letter, at least 1 uppercase, 3
          lowercase, 1 digit, 1 special character
        </small>
        <div
          class="password-validation-errors"
          *ngIf="showPasswordErrors && passwordErrors.length > 0"
        >
          <div class="validation-error" *ngFor="let error of passwordErrors">
            ‚ùå {{ error }}
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirm Password: *</label>
        <input
          type="password"
          id="confirmPassword"
          name="confirmPassword"
          [(ngModel)]="confirmPassword"
          (input)="onConfirmPasswordInput()"
          required
        />
        <div class="password-validation-errors" *ngIf="showPasswordMismatch">
          <div class="validation-error">‚ùå Passwords do not match</div>
        </div>
      </div>

      <div class="form-group">
        <label for="firstName">First Name: *</label>
        <input
          type="text"
          id="firstName"
          name="firstName"
          [(ngModel)]="formData.firstName"
          required
        />
      </div>

      <div class="form-group">
        <label for="lastName">Last Name: *</label>
        <input
          type="text"
          id="lastName"
          name="lastName"
          [(ngModel)]="formData.lastName"
          required
        />
      </div>

      <div class="form-group">
        <label for="gender">Gender: *</label>
        <select
          id="gender"
          name="gender"
          [(ngModel)]="formData.gender"
          required
        >
          <option value="M">Male</option>
          <option value="F">Female</option>
        </select>
      </div>

      <div class="form-group">
        <label for="address">Address: *</label>
        <input
          type="text"
          id="address"
          name="address"
          [(ngModel)]="formData.address"
          required
        />
      </div>

      <div class="form-group">
        <label for="phone">Phone Number: *</label>
        <input
          type="tel"
          id="phone"
          name="phone"
          [(ngModel)]="formData.phone"
          required
        />
      </div>

      <div class="form-group">
        <label for="email">Email: *</label>
        <input
          type="email"
          id="email"
          name="email"
          [(ngModel)]="formData.email"
          required
        />
      </div>

      <div class="form-group credit-card-group">
        <label for="creditCard">Credit Card Number: *</label>
        <div class="credit-card-input-wrapper">
          <input
            type="text"
            id="creditCard"
            name="creditCard"
            [(ngModel)]="formData.creditCard"
            (input)="onCreditCardInput()"
            required
            placeholder="1234567890123456"
            maxlength="16"
          />
          <span class="card-icon" *ngIf="cardType">
            <img
              *ngIf="cardType === 'visa'"
              src="/assets/card-logos/visa.png"
              alt="Visa"
              class="card-logo"
            />
            <img
              *ngIf="cardType === 'mastercard'"
              src="/assets/card-logos/mastercard.png"
              alt="MasterCard"
              class="card-logo"
            />
            <img
              *ngIf="cardType === 'diners'"
              src="/assets/card-logos/diners.png"
              alt="Diners"
              class="card-logo"
            />
          </span>
        </div>
        <small class="field-hint">
          Accepted: Diners (15 digits, 300-303/36/38), MasterCard (16 digits,
          51-55), Visa (16 digits, 4539/4556/4916/4532/4929/4485/4716)
        </small>
      </div>

      <div class="form-group">
        <label for="userType">Register as: *</label>
        <select
          id="userType"
          name="userType"
          [(ngModel)]="formData.userType"
          required
        >
          <option value="tourist">Tourist</option>
          <option value="owner">Cottage Owner</option>
        </select>
      </div>

      <div class="form-group file-upload-group">
        <label for="profilePicture"
          >Profile Picture:
          <span *ngIf="formData.userType === 'owner'" style="color: #666"
            >(Optional - default will be used if not uploaded)</span
          ></label
        >
        <input
          type="file"
          id="profilePicture"
          (change)="onFileSelected($event)"
          accept="image/jpeg,image/jpg,image/png"
        />
        <p class="file-hint">JPG/PNG, 100x100 to 300x300 pixels</p>
        <div *ngIf="previewUrl" class="image-preview">
          <img [src]="previewUrl" alt="Preview" />
          <p>Preview</p>
        </div>
      </div>

      <div class="success-message" *ngIf="successMessage">
        {{ successMessage }}
      </div>

      <!-- Single error message (for general errors) -->
      <div
        class="error-message"
        *ngIf="errorMessage && errorMessages.length === 0"
      >
        {{ errorMessage }}
      </div>

      <!-- Multiple validation errors (from backend) -->
      <div class="error-message" *ngIf="errorMessages.length > 0">
        <p><strong>Please fix the following errors:</strong></p>
        <ul>
          <li *ngFor="let error of errorMessages">{{ error }}</li>
        </ul>
      </div>

      <button type="submit" [disabled]="isLoading || !registerForm.form.valid">
        {{ isLoading ? "Submitting..." : "Register" }}
      </button>
    </form>

    <div class="login-link">
      <p>Already have an account? <a routerLink="/login">Login here</a></p>
    </div>
  </div>
</div>
